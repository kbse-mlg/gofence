{{set . "title" "Home"}}
{{template "header.html" .}}

    <aside class="right-side">
        <!-- Content Header (Page header) -->
        <section class="content-header">
            <div class="col-lg-6 col-md-6 col-sm-5 col-xs-8">
                <div class="header-element">
                    <h3>GoFence/
                        <small>Dashboard</small>
                    </h3>
                </div>
            </div>
        </section>
        <!-- Main content -->
        <section class="content">
            <!-- row -->
            <div class="row">
                <div class="col-lg-12">
                    <!-- Basic charts strats here-->
                    <div class="panel">
                        <div class="panel-heading">
                            <h4 class="panel-title">
                                <i class="ti-map-alt"></i> Location
                            </h4>
                        </div>
                        <div class="panel-body">
                            <div id="gmapid" class="gmap" style="max-height: 600px; height:600px"></div>
                        </div>
                    </div>
                </div>
            <!-- row -->
        </section>
    </aside>
    <script type='text/javascript'>
        $(document).ready(function(){
           
            // initialize the map on the "map" div with a given center and zoom
            var map = L.map('gmapid', {
                center: [3.1290962786081646, 101.67658295822144],
                zoom: 17
            });

            L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
                attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
                maxZoom: 18,
                id: 'mapbox.streets',
                accessToken: 'pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw'
            }).addTo(map);
            
            var layers = [];

            $.get( "/api/v1/area", function( data ) {
                if(data && data.Areas){
                    data.Areas.forEach(function(area) {
                        console.log(area);
                        var gsonLayer = L.geoJSON(JSON.parse(area.geodata), {
                            style: function (feature) {
                                return {color: feature.properties.color};
                            }
                        }).bindPopup(function (layer) {
                            return layer.feature.properties.description;
                        });
                        layers.push(gsonLayer);
                        gsonLayer.addTo(map);
                    }, this);
                }
            });
        });
    </script>
    <script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"
   integrity="sha512-A7vV8IFfih/D732iSSKi20u/ooOfj/AGehOKq0f4vLT1Zr2Y+RX7C+w8A1gaSasGtRUZpF/NZgzSAu4/Gc41Lg=="
   crossorigin=""></script>
{{template "footer.html" .}}
